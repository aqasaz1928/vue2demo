define("common/js/antifake",["require"],function(){var t=function(){this.staticQueue=[],this.asyncQueue=[],this.status="running"};t.prototype={next:function(t,n){return n?(this.staticQueue.push("async"),this.asyncQueue.push(t)):this.staticQueue.push(t),this},wait:function(t){var n=this;return this.next(function(){setTimeout(function(){n.wake.call(n)},t)},!0),this},run:function(){for(;this.staticQueue.length>0;){if("sleep"===this.status)return;var t=this.staticQueue.shift();"string"==typeof t&&"async"==t&&(t=this.asyncQueue.shift(),this.status="sleep"),t.call(this)}},wake:function(){this.status="running",this.run()}};var n,e,i,o,s=function(t,n,e){return e&&(n+=1),parseInt(Math.random()*(n-t)+t)},r=function(t){return 10>t?"0"+t:t},u=function(t,n){return"0."+r(s(t,n))},a=function(t,n){var e=Math.floor(t-16*n/9)/2,i=Math.floor(n-9*t/16)/2;e=e>0?e:0,i=i>0?i:0,t-=2*e,n-=2*i;var o=[{x:Math.floor(t*u(1,80)+e),y:20},{x:Math.floor(t*u(1,10)+e),y:Math.floor(n*u(1,80)+i)},{x:Math.floor(t*u(70,80)+e),y:Math.floor(n*u(1,80)+i)},{x:Math.floor(t*u(1,80)+e),y:Math.floor(n*u(70,80)+i)}];return o[s(0,4)]},f=60,c=null,p=[],h=0,l=10,d=10,x=1,v=3,g=0,m=!1,y=!1,I={},M=function(){d=l,x=1,v=3},O=new t,w=function(){m=!1,g=s(x,v,!0),d-=g,v=v>=d?d:v,setTimeout(function(){m=!0,y=!1},1e3*g)},Q=function(){i&&i.remove(),i=null,e=$(".video-js");var t=e.children("div"),n=t.eq(Math.floor(Math.random()*t.length)),r="12px",u=e.width();u>1300?(u="240",r="16px"):u>1e3?(u="220px",r="14px"):u="180px",o=u;var f="position: absolute; z-index: 998; padding: 5px;";f+="font-weight:bold; color:#000; opacity:0.2;",f+="text-shadow: 1px 0 0px #fff, -1px 0 0px #fff, 0 1px 0px #fff, 0 -1px 0px #fff",f+="font-size: "+r+"; width: "+u;var c='<div style="'+f+'"></div>';h=1==p.length?0:s(0,10)%2,i=$(c).html(p[h]),Math.random()>.5?n.before(i):n.after(i),I=a(e.width(),e.height()-40),i.css({top:I.y+"px",left:I.x+"px"})},b=function(){return clearTimeout(c),m?(i&&i.remove(),void(i=null)):void(c=setTimeout(function(){C(b)},500))},C=function(t){if(0==$("#video-container video").length)return void k.stop();if(m)return i&&i.remove(),void(i=null);var n=0;if($(".video-js div").each(function(t,e){-1!=p.indexOf($(e).html())&&(n=1)}),null==i||i.is(":hidden")||-1==p.indexOf(i.html())?n=0:i.css("left")!=I.x+"px"||i.css("top")!=I.y+"px"||"0px"!=i.css("textIndent")?n=0:"5px"!=i.css("paddingLeft")||"5px"!=i.css("paddingTop")||"5px"!=i.css("paddingRight")||"5px"!=i.css("paddingBottom")?n=0:("0px"!=i.css("marginLeft")||"0px"!=i.css("marginTop")||"0px"!=i.css("marginRight")||"0px"!=i.css("marginBottom"))&&(n=0),!n){var e="?cid="+OP_CONFIG.curCourse.id+"&mid="+OP_CONFIG.mid;return $.get("/lesson/ajaxillegal"+e),$("#video-container").html('<p style="color:#fff; text-align:center;padding-top:150px">检测到播放器异常，如您未改动播放器参数，请反馈此问题给慕课网技术人员</p>'),k.stop(),!1}i.css({width:o,textIndent:"0px",padding:"5px",margin:"0",background:"none",color:"#000",display:"block",position:"absolute",zIndex:"998",opacity:"0.2"}),t&&t()},T=function(){return 0>=d||y?!1:(y=!0,void O.wait(1e3*s(1,10)).next(w).next(Q).next(b).run())},k={start:function(){p.length<=0&&(OP_CONFIG.userInfo.phone&&p.push(OP_CONFIG.userInfo.phone+" 正在观看"),p.push("@"+OP_CONFIG.userInfo.uid)),clearInterval(n),n=setInterval(function(){T(),f--,0>=f&&(f=60,M())},1e3)},stop:function(){clearInterval(n),m=!0,y=!1}};return k});